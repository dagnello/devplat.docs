<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" >
<topic xml:lang="en-us" id="jow1404333802962">
    <!-- Modification History
   -->
    <title>Virtual Machines and Carrier-Grade Availability</title>
    <shortdesc>The HP Helion OpenStack Carrier Grade virtualized environment provides a health
        monitoring mechanism that can be used to implement and support the deployment of guest
        applications in Carrier-Grade High Availability (HA) mode.</shortdesc>
    <prolog>
        <author></author>
    </prolog>
    <body>
        <p>A simplified view of the health monitoring system is illustrated in the
            following figure:</p>
        
            <title>Hardware and software health monitoring</title>
            <image href="jow1404333801231.image" id="image_w22_prw_g4"/>
        
        <dl>
            <dlentry>
                <dt>Host monitoring</dt>
                <dd>
                    <p>A host failure occurs when the compute node hardware that
                        hosts the application fails, or when its kernel becomes unresponsive. Host
                        failures are detected by the active controller node through an efficient and
                        scalable monitoring process that runs continuously during normal operation
                        of the HP Helion OpenStack Carrier Grade cluster.</p>
                    <p>When such a failure is detected, HP Helion OpenStack Carrier Grade
                        automatically re-schedules all affected virtual machines for deployment on
                        alternative compute nodes.</p>
                    <p>Host monitoring, and its recovery mechanisms, are always
                        available for every deployed virtual machine in the HP Helion OpenStack Carrier Grade
                        Cluster.</p>
                </dd>
            </dlentry>
            <dlentry>
                <dt>Virtual machine monitoring</dt>
                <dd>
                    <p>From the point of view of a guest application, a hardware failure occurs when the
            hosting virtual machine fails to execute. From the compute node, this means that the
            virtual machine process itself is experiencing execution problems, or that it is no
            longer running.</p>
                    <p>When such a failure is detected, HP Helion OpenStack Carrier Grade
                        automatically tries to restart the affected virtual machine on the same
                        compute node. If the restart operation fails, the virtual machine is
                        automatically scheduled to deploy on an alternative compute node.</p>
                    <p>Virtual machine monitoring, and its recovery mechanisms, are
                        always available for every deployed virtual machine in the HP Helion OpenStack Carrier Grade
                        cluster.</p>
                </dd>
            </dlentry>
            <dlentry>
                <dt>Execution environment</dt>
                <dd>
                    <p>The HP Helion OpenStack Carrier Grade Guest-Client daemon, built into the guest
                        image, verifies the execution environment. If the guest kernel becomes
                        unresponsive, the lack of heartbeat messages from the daemon triggers an
                        alarm on the active controller.</p>
                    <p>For all purposes, the virtual machine is considered then to
                        be at fault, and is therefore re-scheduled for execution, first on the same
                        compute node, and then on a different host if necessary.</p>
                </dd>
            </dlentry>
            <dlentry>
                <dt>Application monitoring</dt>
                <dd>
                    <p>Software failures at the application level can be addressed within the context of the
            following failure scenarios:</p>
                    <dl>
                        <dlentry>
                            <dt>Sudden death of the application process</dt>
                            <dd>
                                <p>The application process ends abruptly, likely because of a software bug in its
                  code.</p>
                            </dd>
                        </dlentry>
                        <dlentry>
                            <dt>The application becomes unresponsive</dt>
                            <dd>
                                <p>Several conditions can lead the application
                                    process to stall, that is, to be unscheduled for additional
                                    work. This may happen because the application is waiting for
                                    some resource that is not available, or because of a bug in the
                                    application's logic.</p>
                            </dd>
                        </dlentry>
                        <dlentry>
                            <dt>The application declares itself to have failed</dt>
                            <dd>
                                <p>Logic built into the application determines conditions under which it must
                  declare itself to be in an unrecoverable error state.</p>
                            </dd>
                        </dlentry>
                    </dl>
                    <p>Handling of these cases is optional, and subject to the
                        proper API integration into the guest application itself.</p>
                    <p>Application monitoring happens when the HP Helion OpenStack Carrier Grade
                        Guest-Client daemon in the virtual machine registers the application for
                        monitoring. What happens after an application failure occurs is determined
                        when the application is registered. By default, an application failure
                        triggers a hard reboot of the virtual machine instance.</p>
                    <p>If the application makes use of the HP Helion OpenStack Carrier Grade Guest
                        Heartbeat API, it can instruct the active controller on how to proceed when
                        the application declares itself in a state of error. This could include a
                        restart of the virtual machine, which in the case of 1:1 HA application/VM
                        pair, would trigger a VM switchover. The application can also use the <term>VM Peer Notification API</term> to receive notifications
                        when virtual machines in the same server group go up or down.</p>
                    <p>Refer to the <cite>HP Helion OpenStack Carrier Grade SDK</cite>
                        for more information on how to configure the Guest-Client daemon and the use
                        of the HP Helion OpenStack Carrier Grade Guest Heartbeat API.</p>
                </dd>
            </dlentry>
        </dl>
        <p>Data persistence is another aspect that impacts the high-availability of
            a running application. This is addressed by providing storage persistence across
            applications restarts for Cinder remote HA block storage using distributed storage
            backends, such as 3PAR, for configuration databases.</p>
        <p>By instrumenting the level of interaction between the guest application
            and the health-monitoring system, and by using the appropriate Cinder storage backends,
            guest applications can be deployed to run in different HA scenarios. Note that in all
            cases, monitoring of hardware and virtual machines, and their corresponding failure
            recovery mechanisms, are always active.</p>
        <section id="section_N100EB_N1001C_N10001">
            <title>HA-unaware Guest Applications</title>
            <p>These are applications designed with no consideration for special
                behavior needed when a failure occurs. Typical scenarios include:</p>
            <ul id="ul_pw1_qws_h4">
                <li>
                    <p>Stateless applications such as web servers serving static data, and data query systems.
            The requirement in these cases is for the application to be running continuously.</p>
                    <p>This requirement is fulfilled when the application is
                        deployed on HP Helion OpenStack Carrier Grade by the automatic monitoring at the hardware and
                        virtual machine levels. Optionally, the application can benefit from all
                        other monitoring levels when the proper instrumentation is in place.</p>
                </li>
                <li>
                    <p>Stateful applications such as an enterprise-level call
                        center, where the application's state is maintained in a database or some
                        form of journaling system. An additional requirement in these cases is for
                        storage persistence across restart operations, that is, for the state to be
                        recoverable when the application restarts.</p>
                    <p>This additional requirement is fulfilled when the application
                        is deployed on HP Helion OpenStack Carrier Grade by the Cinder services, when configured to
                        use distributed storage backends.</p>
                </li>
            </ul>
        </section>
        <section id="section_N10115_N1001C_N10001">
            <title>HA-aware Guest Applications</title>
            <p>Typically, these are legacy applications supporting their own HA
                framework. They are expected to run unmodified, or with minimal changes, when
                deployed on HP Helion OpenStack Carrier Grade.</p>
            <p>As with any other application, HA-aware applications benefit from the
                hardware and virtual machine monitoring processes, which provide them with automatic
                restart upon failures. When coupled with server groups (see <xref href="jow1404333660893.xml"/>), they also benefit from the
                anti-affinity options to ensure that hot/standby running applications are protected
                against hardware failures.</p>
            <p>HA-aware applications also benefit from internal tenant networks on
                top of which the application's HA framework, and any journaling framework it may
                use, can be deployed.</p>
        </section>
    </body>
</topic>