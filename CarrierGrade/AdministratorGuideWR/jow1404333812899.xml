<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE topic   PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" >


<topic id="jow1404333812899" xml:lang="en-us">


    <!-- Modification History


        


-->


    <title>Creating an In/Out Autoscaling Resource</title>


    <shortdesc >The <filepath >CPUScale.yaml</filepath> template


        illustrates the use of a template to create an in/out autoscaling resource. It also shows


        how to customize VM instance images at startup, and how to use custom performance monitoring


        on the guest.</shortdesc>


    <prolog>


        <author >Jim Owens</author>


    </prolog>


    <body>


        <section id="section_N10023_N10020_N10001" >


            <p >This CFN template creates a server group based on a standard instance


                type, specified as a parameter.  The template includes a <b >UserData</b> section that customizes each instance at launch by


                defining a CPU meter and setting it to push information to the controller at regular


                intervals. Instances are added or removed based on this information.</p>


            <p >For in/out scaling, the CPU measurement uses a <b >cpu_util</b>


                meter, which takes into account the total number of available vCPUS for the instance


                when measuring usage.</p>


            <p >Use an <b >admin</b> account to run


                this template.</p>


        </section>


        <section id="section_N10030_N10020_N10001" >


            <p >To use the autoscaling resource in this example, the following


                requirements must be satisfied:</p>


            <ul id="ul_q4q_5kg_w4">


                <li >


                    <p ><i>cloud-init</i> must be


                        available on the guest image. This is required so that the guest can process


                        the <b >UserData</b> configuration


                        supplied at launch. The example image provided with HP Helion OpenStack Carrier Grade includes


                            <i>cloud-init</i>. </p>


                </li>


                <li >


                    <p ><i>heat-cfntools</i>


                        must be available on the guest image. This is required so that the guest can


                        push information to Ceilometer on the controller. The example image provided


                        with HP Helion OpenStack Carrier Grade includes <i>heat-cfntools</i>.</p>


                </li>


                <li >


                    <p >the guest can send data to the controller using the IP


                        address specified in <filepath >/etc/heat/heat.conf</filepath>.</p>


                </li>


            </ul>


        </section>


        <ol>


            <li id="li_N1005C_N10059_N10020_N10001" >


                <p >Collect the required parameter values for this template.</p>


                <ol id="ol_wqc_mlv_34">


                    <li >


                        <p conref="jow1404333809730.xml#jow1404333809730/locate-flavor" />


                    </li>


                    <li >


                        <p conref="jow1404333809730.xml#jow1404333809730/locate-keypair" />


                    </li>


                    <li >


                        <p conref="jow1404333809730.xml#jow1404333809730/locate-image" />


                    </li>


                    <li >


                        <p >On the <menucascade >


                                <uicontrol >Admin</uicontrol>


                                <uicontrol >System Panel</uicontrol>


                                <uicontrol >Networks</uicontrol>


                            </menucascade> page, click the <uicontrol >Name</uicontrol> of each required network in turn, in order to open


                            the Network Overview page and obtain the network <uicontrol >ID</uicontrol>. For this template, a public network


                            ID and an internal network ID are required.</p>


                    </li>


                </ol>


            </li>


            <li conref="jow1404832975002.xml#jow1404832975002/open-stack-list" id="li_N10096_N10059_N10020_N10001" ><p /></li>


            <li conref="jow1404833049288.xml#jow1404833049288/launch-stack" id="li_N1009D_N10059_N10020_N10001" ><p /></li>


            


            <li id="li_N100A4_N10059_N10020_N10001" >


                <p >Select<uicontrol > File</uicontrol>, then click <uicontrol >Browse</uicontrol>


                    and select <filepath >CPUScale.yaml</filepath> from the local disk.</p>


            </li>


            <li id="li_N100CA_N10059_N10020_N10001" >


                <p >Use the <wintitle >Launch Stack</wintitle> form to provide the required


                    parameter values for the template. </p>


                


                    <fig id="fig_N100D4_N100D1_N100C6_N10059_N10020_N10001" >


                        <image alt="CPUScale Launch Stack form" href="jow1404333811339.image" id="image_dvz_1wj_j4"  width="4in"/>


                    </fig>


                    <note id="note_N100E1_N100D1_N100C6_N10059_N10020_N10001" >


                        <p >The parameters are presented in a single column. This image has been


                            edited to present them in two columns.</p>


                    </note>


                


            </li>


            <li id="li_N100F1_N10059_N10020_N10001" importance="optional" >


                <p >Adjust existing values to meet your requirements.</p>




                            <p ><uicontrol >KeyName</uicontrol></p>


                        


                        


                            <p >The <uicontrol >KeyPair</uicontrol>


                                name from the<wintitle > Access &amp;


                                    Security</wintitle> page.</p>


                        


                    


                    


                    


                            <p ><uicontrol >ViFModel</uicontrol></p>


                        


                    


                            <p >The virtual interface model to use. For valid


                                choices, see <cite >Multiple NIC Support</cite> in


                                    <xref href="jow1404333807231.xml" />.</p>


                        


                    


                    


                    


                            <p ><uicontrol >InstanceType</uicontrol></p>


                        


                    


                            <p >The <uicontrol >Flavor


                                    Name</uicontrol> from the <wintitle >Flavors</wintitle> page.</p>


                        


                    


                    


                    


                            <p ><uicontrol >ImageId</uicontrol></p>


                        


                    


                            <p >The <uicontrol >Image


                                    Name</uicontrol> from the <wintitle >Images</wintitle> page.</p>


                        


                    


                    

                            <p ><uicontrol >PublicNetId</uicontrol></p>


                    

                            <p >The <uicontrol >ID</uicontrol> from


                                the <wintitle >Network Overview</wintitle> page.</p>


                    


                    


                    

                            <p ><uicontrol >InternalNetId</uicontrol></p>


                    

                    


                            <p >The <uicontrol >ID</uicontrol> from


                                the <wintitle >Network Overview</wintitle> page.


                                <!-- this and the similar entry above need attention. We need two network IDs (or are the Names enough?) when we collect the parameters. --></p>


                        


                    


                    


                            <p ><uicontrol >MinClusterSize</uicontrol></p>


                        


                    


                            <p >The minimum number of VMs to launch. The stack cannot


                                autoscale below this value.</p>


                        


                    


                    


                    


                            <p ><uicontrol >MaxClusterSize</uicontrol></p>


                        


                    
                            <p >The maximum number of VMs that can be launched.</p>




                    


                    

                            <p ><uicontrol >CustomMeterName</uicontrol></p>


                    

                    


                            <p >The name of a custom Ceilometer metric to store. For


                                information about custom metrics, see <xref href="jow1404916152577.xml" />.</p>


                        


                    


                            <p ><i >CustomMeterUnit</i></p>




                            <p >The unit of measurement to display for the custom


                                metric; for example, 'Percent'.</p>












                            <p ><i>MetricHighWaterMark</i></p>


                        


                            <p >The value that triggers autoscaling to add


                                resources.</p>




                    








                            <p ><i>MetricLowWaterMark</i></p>


                        


                        


                            <p >The value that triggers autoscaling to remove


                                resources.</p>


                        


                    


                


            </li>


        </ol>


    </body>


</topic>
