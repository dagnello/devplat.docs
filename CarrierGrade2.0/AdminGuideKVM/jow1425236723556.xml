<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" >
<topic id="jow1425236723556" xml:lang="en-us">
<!-- Modification History
        
-->
    <title>Pinning a Guest NUMA Node to a Host NUMA Node</title>
    <shortdesc>You can use flavor extra specs or image properties to pin a guest NUMA
        node to a host NUMA node.</shortdesc>
    <prolog><author/>
        <author/>
    </prolog>
    <body>
        
            <p>By default, when instances are launched or migrated, the virtual NUMA
                nodes defined for the VMs are mapped to available host NUMA nodes. You can
                optionally designate a specific host NUMA node for a virtual NUMA node, using either
                a flavor extra specification (which takes the general form <codeph>hw:specification</codeph>), or an image property (which
                takes the general form <codeph>hw_specification</codeph>).
                This enables you to co-locate VM processes with AVS vSwitch processes for
                high-performance networking. </p>
            <p><!-- For information about exposing multiple NUMA nodes to a VM, see <xref
                    href="jow1425236666266.xml"/>. -->For
                information about assigning vSwitch processes to host NUMA nodes, see <xref href="jow1404333768530.xml"/>.</p>
            <p>For a VM with only one virtual NUMA node, you can use an extra specification to
                specify the host NUMA node.
                <!--This is the Horizon-based implementation of the old way of assigning NUMA nodes, still extant. Presumably Horizon will be updated later to reflect the changes in NUMA node handling that inspired the current topic and related topics covering US51010. -->
                To add this extra spec to a flavor using the web administration interface, use the
                    <b>NUMA Node</b> selection in the <b>Create Flavor Extra Spec</b> drop-down menu. This
                provides fields to associate a <b>Guest NUMA Node</b> with a
                    <b>Host NUMA Node</b>. To access this menu, see <xref href="jow1429538642910.xml"/>.</p>
            <p>You can also pin NUMA nodes using the CLI.  The following extra
                specification assigns a specific host NUMA node to a virtual NUMA node:</p>
            <codeblock>hw:numa_node.vnode_id=pnode_id</codeblock>
            <p>where</p>
            <parml>
                <plentry>
                    <pt><parmname>vnode_id</parmname></pt>
                    <pd>
                        <p>is the number used to identify the virtual NUMA node (0
                            for the first node, 1 for the second, and so on).</p>
                    </pd>
                </plentry>
                <plentry>
                    <pt><parmname>pnode_id</parmname></pt>
                    <pd>
                        <p>is the number used to identify the host NUMA node (0 for
                            the first node, 1 for the second, and so on).</p>
                    </pd>
                </plentry>
            </parml>
            <p>For example, given flavor <codeph>numa.pinned.asym</codeph>, use the following command to assign virtual
                NUMA node 0 to host NUMA node 1:</p>
            <codeblock>~(keystone_admin)$ nova flavor-key numa.pinned.asym set hw:numa_node.0=1</codeblock>
        
    </body>
</topic>