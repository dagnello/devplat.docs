<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" >
<topic ditaarch:DITAArchVersion="1.2" domains="(topic task topic)                            (topic hi-d)                            (topic pr-d)                            (topic sw-d)                            (topic ui-d)                            (topic wr-sw-d)                            (topic xml-d)   " id="psa1411061325242">
<!-- Modification History
        
-->
    <title>Backing Up Available Cinder Volumes</title>
    <shortdesc>You can back up Cinder volumes in the <i>available</i>
        state.</shortdesc>
    <prolog><author/>
        <author/>
    </prolog>
    <body>
        
            <p>A Cinder volume in the <i>available</i> state is the ideal
                candidate for a backup operation in that there are no running instances using it. </p>
        
       
            
            
            <ol>
            
                <li conref="psa1410446807133.xml#psa1410446807133/cli-admin-login"/>
             
                <li>Identify the volume you want to back up.
                 <ol>
                    
                        <li>List Cinder volumes from all tenants.
                        
                            <codeblock>
~(keystone_admin)$ cinder list --all-tenants﻿
+--------------+-----------+-----------------+------+-------------+----------
|   ID         |   Status  |   Display Name  | Size | Volume Type | Bootable 
+--------------+-----------+-----------------+------+-------------+----------
| 593111d8-... | in-use    | volume-1        |  1   |     None    |   true   
| 53ad007a-... | available | volume-2        |  10  |     None    |   false  
+--------------+-----------+-----------------+------+-------------+----------
+---------------+
| Attached to   |
+---------------+
|  ﻿b998107b-... |
|               |
+---------------+﻿</codeblock>
                        
                        
                            <p>Cinder volumes are listed also on the <b>Volumes</b> page of the web
                                administration interface.</p>
                        
                        </li>                    
                    
                        <li>Identify the volume to back up.
                        
                            <p>In the list above, <codeph>volume-1</codeph> is a disk image associated with a
                                running instance. The volume <codeph>volume-2</codeph>, with UUID <codeph>53ad007a-...</codeph>, is available and can be safely
                                backed up. </p>
                        </li>
                    
                </ol>
                </li>
             
                <li>Export the target volume to the controller's file system.
                
                    <codeblock>
~(keystone_admin)$ cinder export 53ad007a-841a-4fd3-a22b-813d4a6a8a85
+---------------------+--------------------------------------+
|       Property      |                Value                 |
+---------------------+--------------------------------------+
| display_description |                                      |
|          id         | 53ad007a-841a-4fd3-a22b-813d4a6a8a85 |
|         size        |                  1                   |
|        status       |              exporting               |
|      updated_at     |      2014-09-18T21:36:15.247881      |
|     volume_type     |                 None                 |
+---------------------+--------------------------------------+</codeblock>
                
                
                    <p>Exporting the volume takes some time, longer times for larger
                        volumes. While it is taking place, the status of the volume is set to <i>exporting</i>, which you can verify by issuing the
                        command <cmdname>cinder show </cmdname>
                        UUID, or <cmdname>cinder list
                            --all-tenants</cmdname> again. This new state is automatically reported
                        on the Web administration interface.</p>
                    <p>You must wait for the export operation to complete. Use the
                        command <cmdname>cinder show 53ad007a-...</cmdname> and look for the
                            <codeph>backup_status</codeph> field to determine whether the
                        export operation was successful. The state of the volume should be set to
                            <i>available</i> again.</p>
                
                
                    <p>When the export operation completes, the backup file is ready, as illustrated
                        in the following example:</p>
                    <codeblock>
~(keystone_admin)$ ls -lh /opt/backups
total 306M
drwx------ 2 root root  16K Sep 10 17:42 lost+found
drwxr-xr-x 2 root root 4.0K Sep 18 21:42 temp
-rw-r--r-- 1 root root 305M Sep 18 21:42 volume-53ad007a-841a-4fd3-a22b-813d4a6a8a85-20140918-213918.tgz</codeblock>
                
                </li>            
             
                <li>Transfer the backup file to an external storage resource.
                
                    <p>The following example uses the <cmdname>scp</cmdname> command to transfer the
                        backup file to the directory <filepath>/backups/titanium</filepath> on a
                        server named <codeph>backups-server.wrs.com</codeph>:</p>
                
                
                    <codeblock>~(keystone_admin)$ scp /opt/backups/volume-53ad007a-841a-4fd3-a22b-813d4a6a8a85-20140918-213918.tgz admin@backups-server.wrs.com:/backups/titanium</codeblock>
                
                </li>
             
                <li> importance="optional">Delete the backup file.
                
                    <p>You may want to free up disk space on the controller to
                        accommodate additional Cinder volume backups.</p>
                </li>
                 
        </ol>
        
            <p>The volume backup is complete. Repeat this procedure with all other Cinder volumes in
                the <i>available</i> state in the system.</p>
        
    </body>
</topic>