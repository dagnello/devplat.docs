<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="install_dcn">
  <title>HPE Helion <tm tmtype="reg">OpenStack</tm> 2.0: Installation for Helion Entry-scale Cloud
    with HP Distributed Cloud Networking</title>
  <body>
    <note type="attention">Hyperlinks intermittently do not work in the Google Chrome browser. <xref
        href="http://docs.hpcloud.com/helion/installation/install_entryscale_dcn.html"
        scope="external" format="html">Click here</xref> for a frameless version of this page where
      the links should work.</note>
    <section id="about">
      <p>This page describes the installation steps that are required for the HPE Helion OpenStack
        Entry-scale cloud models that utilizes HP Distributed Cloud Networking (DCN) 3.2R4. We
        explain how to deploy this model during the HPE Helion OpenStack 2.0 deployment.</p>
    </section>
    <section id="notes"><title>Notes and Limitations</title>
      <p>The VRS installation is only supported on the KVM hypervisor.</p>
    </section>
    <section id="prereqs"><title>Before You Start</title>
      <p>In order to use this model you must have received your HP Distributed Cloud Networking
        license and software. You can learn more about this product <xref
          href="http://www8.hp.com/us/en/products/networking-switches/product-detail.html?oid=7268885"
          scope="external" format="html">here</xref>.</p>
    </section>
    <section conref="install_entryscale_kvm.dita#install_kvm/setup_deployer"/>
    <section id="configure"><title>Configure Your Environment</title>
      <p>During the configuration phase of the installation you will be making modifications to the
        example configuration input files to match your cloud environment. You should use the <xref
          href="../example_configurations.dita">Example Configurations</xref> documentation for
        detailed information on how to do this.</p>
      <p>In the steps below we show how to set up the directory structure with the example input
        files as well as use the optional encryption methods for your sensitive data.</p>
      <ol>
        <li>Copy the DCN tarball to the lifecycle manager and uncompress it: <codeblock>cd ~ &#38;&#38; tar -xzvf dcn-hlm-20151105T225620Z.tgz</codeblock>
          <p>This archive contains all of the Ansible playbooks used to deploy the VRS and
            neutron-plugins.</p></li>
        <li>Copy the VRS and Neutron-Plugin tarballs to the lifecycle manager: <codeblock>scp dcn-vrs-20151105T225620Z.tgz stack@&#60;IP_OF_DEPLOYER>:/opt/hlm_packager/
scp dcn-plugin-20151105T225620Z.tgz stack@&#60;IP_OF_DEPLOYER>:/opt/hlm_packager/</codeblock>
          <p>These two archives contain the packaged Neutron plugins as well as the VRS packages,
            including all of the dependencies that are needed.</p>
        </li>
        <li>Copy the example configuration files for the DCN model into your definition directory
          with this command:
          <codeblock>cp -r ~/helion/my_cloud/examples/dcn/* ~/helion/my_cloud/definition/</codeblock>
        </li>
        <li>Edit the <codeph>~/helion/my_cloud/definition/data/servers.yml</codeph> file to add the
          VSC and VSD configuration variables:
          <codeblock>---
  product:
     version: 2
  
  pass-through:
     global:
  
        # DCN Plugin Configuration
        #
        dcn_vsd_hostname: vsd_host
        dcn_vsd_user: foo
        dcn_vsd_passwd: bar
        dcn_vsd_auth_resource: /foobar
        dcn_vsd_organization: foobar
        # (BoolOpt) Boolean for SSL connection with VSD server
        dcn_vsd_serverssl: True
        # (StrOpt) Nuage provided base uri to reach out to VSD
        dcn_vsd_base_uri: /nuage/api/v3_2
        
        # DCN VRS Configuration
        #
        dcn_vsc_active_ip: 10.0.5.1
        dcn_vsc_passive_ip: 10.0.5.2
        dcn_vrs_nic: eth0
        dcn_vrs_bridge: alubr0
        
   servers:
   
     - id: computeX
       ip-addr: 10.0.0.10
       role: COMPUTE-DCN-ROLE
       ....</codeblock></li>
        <li>Ensure that all of the <codeph>role</codeph> values for each of your Compute nodes are
          changed from <codeph>COMPUTE-ROLE</codeph> to <codeph>COMPUTE-DCN-ROLE</codeph> like you
          see in the example above.</li>
        <li>Edit the <codeph>~/helion/my_cloud/definition/data/server_roles.yml</codeph> and add the
          definition for the <codeph>COMPUTE-DCN-ROLE</codeph>. <p>Example:</p>
          <codeblock>---
   product:
      version: 2
   
   server-roles:
     - name: COMPUTE-DCN-ROLE
       interface-model: COMPUTE-INTERFACES
       disk-model: COMPUTE-DISKS</codeblock></li>
        <li>Edit the <codeph>~/helion/my_cloud/definition/data/control_plane.yml</codeph> file and
          add the line below to specify the DCN component: <codeblock>- dcn-plugin</codeblock></li>
        <li>Also in the <codeph>~/helion/my_cloud/definition/data/control_plane.yml</codeph> file,
          add a new section for the <codeph>ROLE-DCN-COMPUTE</codeph> role:
          <codeblock>
  - name: dcn-compute
    resource-prefix: dcn-comp
    server-role: ROLE-DCN-COMPUTE
    min-count: 1
    allocation-policy: any
    service-components:
       - ntp-client
       - nova-kvm
       - nova-compute-kvm
       - nova-compute
       - dcn-vrs</codeblock></li>
        <li>Enable the deployment of DCN with the following command:
          <codeblock>echo '-include: dcn-deploy.yml' >> ~/helion/hos/ansible/hlm-deploy.yml</codeblock></li>
        <li>Commit your configuration to the <xref href="using_git.dita">local git repo</xref>, as
          follows:
          <codeblock>cd ~/helion/hos/ansible
git add -A
git commit -m "My config or other commit message"</codeblock></li>
      </ol>
    </section>
    <section conref="install_entryscale_kvm.dita#install_kvm/provision"/>
    <section conref="install_entryscale_kvm.dita#install_kvm/deploy"/>

    <section id="post_deploy"><title>DCN on an Existing Installation</title>
      <p>If you have already deployed a HPE Helion OpenStack 2.0 cloud and want to add DCN to it,
        follow the steps in the <xref href="install_entryscale_dcn.dita#install_dcn/configure"
          >Configure Your Cloud</xref> section to setup your configuration files and commit them to
        your local git repository. Once you have completed that, then run the following
        commands:</p>
      <ol>
        <li>Run the configuration processor with this command:
          <codeblock>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</codeblock></li>
        <li>Use the playbook below to create a deployment directory:
          <codeblock>cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost ready-deployment.yml</codeblock></li>
        <li>Deploy DCN:
          <codeblock>cd ~/scratch/ansible/next/hos/ansible/
ansible-playbook -i hosts/verb_hosts dcn-deploy.yml</codeblock></li>
      </ol>
    </section>
  </body>
</topic>
