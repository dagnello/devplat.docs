<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" ><topic xml:lang="en-us" id="topic35632">
<title>HPE Helion Public Cloud Image Service API Specifications</title>
<prolog>
<metadata>
<othermeta name="layout" content="default"/>
</metadata>
</prolog>
<body>
<p>
<!--PUBLISHED-->
 <!--./content/api/c1.1/glance-api.md-->
 <!--permalink: /publiccloud/api/image/--></p>
<p>
<b>Date:</b> May 2014</p>
<p>
<b>Document Version:</b> 1.5</p>
<section id="1-overview"> <title>1. Overview</title>
<p>This document describes the HPE Helion Public Cloud Image service, which is based on <tm tmtype="reg">OpenStack</tm> Glance.</p>
<p>We will be referring to HPE Helion Public Cloud Image Service in this document as simply the Image service.</p>
</section>
<section id="11-api-maturity-level"> <title>1.1 API Maturity Level</title>
</section>
<section id="111-maturity-level-definitions"> <title>1.1.1 Maturity Level Definitions</title>
<p>The maturity levels are defined as follows:</p>
<ul>
<li>
<p>Beta. The functions and features are available publically. While HPE expects the feature to operate as advertised, we do not offer a Service Level Agreement (SLA) for the service or feature.</p>
</li>
<li>
<p>Release to General Availability (GA). At this level of maturity, all features and functions are expected to operate as advertised. In particular, there is a Service Level Agreement (SLA) defined and in place.</p>
</li>
</ul>
</section>
<section id="112-maturity-level"> <title>1.1.2 Maturity Level</title>
<p>
<b>Maturity Level</b>: GA</p>
<p>
<b>Version API Status</b>: <i>1.1</i>
</p>
</section>
<section id="12-document-revision-history"> <title>1.2 Document Revision History</title>
<table>
<tgroup cols="3">
<colspec colname="col1"/>
<colspec colname="col2"/>
<colspec colname="col3"/>
<thead>
<row>
<entry align="left">Document Version</entry>
  <entry align="left">Date</entry>
  <entry align="left">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left">1.0</entry>
  <entry align="left">December 2012</entry>
  <entry align="left">Initial creation</entry>
</row>
<row>
<entry align="left">1.1</entry>
  <entry align="left">Janurary 2013</entry>
  <entry align="left">Added custom image properties</entry>
</row>
<row>
<entry align="left"/>
  <entry align="left"/>
  <entry align="left">Added Image Ownership and Sharing</entry>
</row>
<row>
<entry align="left"/>
  <entry align="left"/>
  <entry align="left">Added Authentication and Access Controls</entry>
</row>
<row>
<entry align="left"/>
  <entry align="left"/>
  <entry align="left">Added Account Level View</entry>
</row>
<row>
<entry align="left">1.2</entry>
  <entry align="left">March 2013</entry>
  <entry align="left">Changes per QA's comment</entry>
</row>
<row>
<entry align="left">1.3</entry>
  <entry align="left">April 2014</entry>
  <entry align="left">Updated Sections 1.1.2, 3.2, 3.3</entry>
</row>
<row>
<entry align="left">1.4</entry>
  <entry align="left"/>
  <entry align="left">Updated curl examples to reflect correct endpoint</entry>
</row>
<row>
<entry align="left"/>
  <entry align="left"/>
  <entry align="left">Updated references to Project instead of Tenant</entry>
</row>
<row>
<entry align="left">1.5</entry>
  <entry align="left">May 2014</entry>
  <entry align="left">HPE Helion updates</entry>
</row>
</tbody>
</tgroup>
</table>
</section>
<section id="2-architectural-view"> <title>2. Architectural View</title>
</section>
<section id="21-overview"> <title>2.1 Overview</title>
<p>The Image service is a web service for managing virtual machine images. It provides a set of RESTful APIs that enables querying/updating of image metadata as well as retrieval of the actual image data.</p>
</section>
<section id="22-images"> <title>2.2 Images</title>
</section>
<section id="221-image-files"> <title>2.2.1 Image Files</title>
<p>An image file refers to a virtual disk image file that Compute service can load up to create a virtual machine.</p>
</section>
<section id="222-image-metadata"> <title>2.2.2 Image Metadata</title>
<p>The metadata of an image includes all the information about the image, e.g. image identifier, name, status, size, disk format, container format, owner, and custom properties. Not all metadata are required to be specified with a value when adding a new image to Image service, more details can be found in <xref type="section" href="#topic35632/4422-add-a-new-image">section 4.4.2.2</xref>.</p>
</section>
<section id="2221-name"> <title>2.2.2.1 Name</title>
<p>Its value should be the name of the image. Note that the name of an image is not unique as it would be unrealistic to expect users to know all the unique names of all other user's images.</p>
</section>
<section id="2222-identifier"> <title>2.2.2.2 Identifier</title>
<p>Each image has an identifier, which is guaranteed to be unique to a Region. For Regions please
        refer to <xref href="#topic35632/32-regions" format="dita">section
        3.2</xref>. Images identifiers are UUIDs, commonly represented in hexadecimal string
        notation.</p>
</section>
<section id="2223-status"> <title>2.2.2.3 Status</title>
<p>Images in the Image service can be in one the following statuses:</p>
<ul>
<li>
<p>
<b>queued</b> The image identifier has been reserved for an image in the Image service. No image data has been uploaded to the Image service and the image size was not explicitly set to zero on creation.</p>
</li>
<li>
<p>
<b>saving</b> Denotes that an image's raw data is currently being uploaded to the Image service. When an image is registered with a call to <codeph>POST /images</codeph> and there is an <codeph>x-image-meta-location</codeph> header present, that image will never be in the saving status (as the image data is already available in some other location).</p>
</li>
<li>
<p>
<b>active</b> Denotes an image that is fully available in the Image service. This occurs when the image data is uploaded, or the image size is explicitly set to zero on creation.</p>
</li>
<li>
<p>
<b>killed</b> Denotes that an error occurred during the uploading of an image's data, and that the image is not readable.</p>
</li>
<li>
<p>
<b>deleted</b> The Image service has retained the information about the image, but it is no longer available to use. An image in this state will be removed automatically at a later date.</p>
</li>
<li>
<p>
<b>pending_delete</b> This is similiar to deleted, however, the image data has not yet been removed. An image in this state is recoverable.</p>
</li>
</ul>
</section>
<section id="2224-disk-and-container-format"> <title>2.2.2.4 Disk and Container Format</title>
<p>When adding an image to the Image service, specifying the image's disk format and container format is required.</p>
<p>The following lists all the formats that the Image service allows.  The Compute service may only support a subset of them, please refer to Compute document for more details.</p>
</section>
<section id="disk-format"> <title>Disk Format</title>
<p>The disk format of a virtual machine image is the format of the underlying disk image. Virtual appliance vendors have different formats for laying out the information contained in a virtual machine disk image.</p>
<p>You can set your image's disk format to one of the following:</p>
<ul>
<li>
<p>
<b>raw</b> This is an unstructured disk image format</p>
</li>
<li>
<p>
<b>vhd</b> This is the VHD disk format, a common disk format used by virtual machine monitors from VMWare, Xen, Microsoft, VirtualBox, and others</p>
</li>
<li>
<p>
<b>vmdk</b> Another common disk format supported by many common virtual machine monitors</p>
</li>
<li>
<p>
<b>vdi</b> A disk format supported by VirtualBox virtual machine monitor and the QEMU emulator</p>
</li>
<li>
<p>
<b>iso</b> An archive format for the data contents of an optical disc (e.g. CDROM).</p>
</li>
<li>
<p>
<b>qcow2</b> A disk format supported by the QEMU emulator that can expand dynamically and supports Copy on Write</p>
</li>
<li>
<p>
<b>aki</b> This indicates what is stored in the Image service is an Amazon kernel image</p>
</li>
<li>
<p>
<b>ari</b> This indicates what is stored in the Image service is an Amazon ramdisk image</p>
</li>
<li>
<p>
<b>ami</b> This indicates what is stored in the Image service is an Amazon machine image</p>
</li>
</ul>
</section>
<section id="container-format"> <title>Container Format</title>
<p>The container format refers to whether the virtual machine image is in a file format that also contains metadata about the actual virtual machine.</p>
<p>Note that the container format string is not currently used by the Image service or other OpenStack components, so it is safe to simply specify bare as the container format if you are unsure.</p>
<p>You can set your image's container format to one of the following:</p>
<ul>
<li>
<p>
<b>bare</b> This indicates there is no container or metadata envelope for the image</p>
</li>
<li>
<p>
<b>ovf</b> This is the OVF container format</p>
</li>
<li>
<p>
<b>aki</b> This indicates what is stored in the Image service is an Amazon kernel image</p>
</li>
<li>
<p>
<b>ari</b> This indicates what is stored in the Image service is an Amazon ramdisk image</p>
</li>
<li>
<p>
<b>ami</b> This indicates what is stored in the Image service is an Amazon machine image</p>
</li>
</ul>
</section>
<section id="2225-size"> <title>2.2.2.5 Size</title>
<p>The image size in Bytes.</p>
</section>
<section id="2226-checksum"> <title>2.2.2.6 Checksum</title>
<p>The MD5 checksum of the image file data.</p>
</section>
<section id="2227-min-ram"> <title>2.2.2.7 Min-ram</title>
<p>The minimum ram required in megabytes to run this image on a HPE Compute server. Please refer to HPE Compute document for more details about this property.</p>
</section>
<section id="2228-min-disk"> <title>2.2.2.8 Min-disk</title>
<p>The minimum disk space required in gigabytes to run this image on a HPE Compute server. Please refer to HPE Compute document for more details about this property.</p>
</section>
<section id="2229-owner"> <title>2.2.2.9 Owner</title>
<p>The Image service normally sets the owner of an image to be the Project ID of the authenticated user adding the image.</p>
</section>
<section id="22210-custom-image-properties"> <title>2.2.2.10 Custom Image Properties</title>
<p>The Image service allows a set of custom, free-form image properties stored with the image metadata. There is no limit on the number of free-form key/value attributes that can be attached to the image. However, keep in mind that the 8K limit on the size of all HTTP headers sent in a request will effectively limit the number of image properties.</p>
</section>
<section id="properties-added-by-the-compute-service-when-creating-a-snapshot"> <title>Properties added by the Compute service when creating a snapshot</title>
<p>HPE Compute adds some or all of the following custom properties to instance snapshots it creates.</p>
<table>
<tgroup cols="4">
<colspec colname="col1"/>
<colspec colname="col2"/>
<colspec colname="col3"/>
<colspec colname="col4"/>
<thead>
<row>
<entry align="left">Name</entry>
  <entry align="left">Description</entry>
  <entry align="left">Example</entry>
  <entry align="left">Comment</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left">architecture</entry>
  <entry align="left">arch type</entry>
  <entry align="left">'x86_64' or 'i686'</entry>
  <entry align="left"/>
</row>
<row>
<entry align="left">image_location</entry>
  <entry align="left">location</entry>
  <entry align="left">'snapshot' or 'local'</entry>
  <entry align="left"/>
</row>
<row>
<entry align="left">image_state</entry>
  <entry align="left">state</entry>
  <entry align="left">'available' or 'creating'</entry>
  <entry align="left"/>
</row>
<row>
<entry align="left">owner_id</entry>
  <entry align="left">Project ID of the owner</entry>
  <entry align="left"/>
  <entry align="left"/>
</row>
<row>
<entry align="left">user_id</entry>
  <entry align="left">user name of the owner</entry>
  <entry align="left"/>
  <entry align="left"/>
</row>
<row>
<entry align="left">instance_uuid</entry>
  <entry align="left">uuid of creating instance</entry>
  <entry align="left"/>
  <entry align="left"/>
</row>
<row>
<entry align="left">instance_ref</entry>
  <entry align="left">reference URL</entry>
  <entry align="left"/>
  <entry align="left"/>
</row>
<row>
<entry align="left">ramdisk_id</entry>
  <entry align="left">Image ID of associated Ramdisk</entry>
  <entry align="left"/>
  <entry align="left"/>
</row>
<row>
<entry align="left">kernel_id</entry>
  <entry align="left">Image ID of associated Kernel Image</entry>
  <entry align="left"/>
  <entry align="left">typically None</entry>
</row>
<row>
<entry align="left">image_type</entry>
  <entry align="left">type</entry>
  <entry align="left">'snapshot'</entry>
  <entry align="left"/>
</row>
<row>
<entry align="left">backup_type</entry>
  <entry align="left"/>
  <entry align="left"/>
  <entry align="left">typically None</entry>
</row>
</tbody>
</tgroup>
</table>
</section>
<section id="properties-added-to-public-images"> <title>Properties added to Public Images</title>
<p>The Image service adds many properties to public images. They are implemented as custom properties, as follow.</p>
<table>
<tgroup cols="5">
<colspec colname="col1"/>
<colspec colname="col2"/>
<colspec colname="col3"/>
<colspec colname="col4"/>
<colspec colname="col5"/>
<thead>
<row>
<entry align="left">Name</entry>
  <entry align="left">Description</entry>
  <entry align="left">Type</entry>
  <entry align="left">Example</entry>
  <entry align="left">Comment</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left">com.hp_1_os_distro</entry>
  <entry align="left">OS name</entry>
  <entry align="left">string</entry>
  <entry align="left">'org.ubuntu', 'org.centos', 'com.microsoft.server'</entry>
  <entry align="left">Will track org.openstack_1_os_distro in the future</entry>
</row>
<row>
<entry align="left">com.hp_1_os_version</entry>
  <entry align="left">OS version</entry>
  <entry align="left">string</entry>
  <entry align="left">'12.04', '5.6', '2008 R2 Enterprise SP1'</entry>
  <entry align="left">Will track org.openstack_1_os_version in the future</entry>
</row>
<row>
<entry align="left">com.hp_1_image_type</entry>
  <entry align="left">image type</entry>
  <entry align="left">string</entry>
  <entry align="left">'kernel', 'ramdisk', 'machine', 'disk'</entry>
  <entry align="left">machine == AMI; disk == qcow2 raw image; this property will not be required when the glance API properties disk_format, container_format are visible to the DEVEX UI</entry>
</row>
<row>
<entry align="left">com.hp_1_image_lifecycle</entry>
  <entry align="left">image lifecycle state</entry>
  <entry align="left">string</entry>
  <entry align="left">'deprecated' or 'active'</entry>
  <entry align="left">absense of (a value for) this property should be interpreted as 'active'</entry>
</row>
<row>
<entry align="left">com.hp_1_provider</entry>
  <entry align="left">WHO provides the image</entry>
  <entry align="left">string</entry>
  <entry align="left">com.hp, com.canonical, com.activestate etc.</entry>
  <entry align="left">note a ubuntu image built by HPE would have com.hp as the provider</entry>
</row>
<row>
<entry align="left">com.hp_1_bootable_volume</entry>
  <entry align="left">is this image compatible with bootable volumes?</entry>
  <entry align="left">boolean</entry>
  <entry align="left">true or false</entry>
  <entry align="left">in the absense of this flag assume the image is compatible with bootable volumes</entry>
</row>
</tbody>
</tgroup>
</table>
</section>
<section id="hp-image-license-property"> <title>hp_image_license property</title>
<p>The hp_image_license property is custom to HPE Helion and has the following semantics:</p>
<ul>
<li>
<p>Value is private to HPE Helion;</p>
</li>
<li>
<p>Not removable once set;</p>
</li>
<li>
<p>Will be copied to all snapshots taken in Nova using the image;</p>
</li>
<li>
<p>Applicable to non-public Windows images (snapshots);</p>
</li>
<li>
<p>Applied to Windows images only by HPE Helion</p>
</li>
</ul>
</section>
<section id="23-image-ownership-and-sharing"> <title>2.3 Image Ownership and Sharing</title>
<p>The ownership of an image is defined by the value of its 'owner' attribute, as mentioned in section 2.2.2.9. The value of this attribute can be NULL, which indicates that the image is not owned by any specific Project. Ownership of an image is shared across all users that belong to the Project identified in the 'owner' attribute of an image.</p>
<p>An image can be shared with another Project by its owner, in which case the original owner can also indicate whether the recipient can share the image further. Modification of shared images is still restricted to the user that owns it.</p>
</section>
<section id="24-authentication-and-access-controls"> <title>2.4 Authentication and Access Controls</title>
</section>
<section id="241-authentication"> <title>2.4.1 Authentication</title>
<p>The Image service depends on Control Service (CS) API to handle authentication of clients. An Image service consumer must obtain an authentication token from CS and send it along with all API requests to Image Service through the <codeph>X-Auth-Token</codeph> header. The Image service will communicate back to CS to verify the token validity and obtain the consumer's identity credentials. Anonymous users cannot access Image service APIs.</p>
</section>
<section id="242-access-control"> <title>2.4.2 Access Control</title>
<p>Access to an image is controlled with the ownership of the image and whether the image is public or private.</p>
<p>Public images with an owner can be accessed by any user, but modifications are restricted to a user under the Project that owns it or Admin users.</p>
<p>Public images without an owner may be accessed by anyone, but modifications are restricted solely to Admins.</p>
<p>Adding a public image to the Image service is only allowed for users with a privileged role.</p>
<p>Private images with an owner can only be accessed or modified by the user that owns it or Admin users.</p>
<p>Private images may also have a null owner. These images will only be accessible and modifiable by Admins.</p>
</section>
<section id="3-account-level-view"> <title>3. Account Level View</title>
</section>
<section id="31-accounts"> <title>3.1 Accounts</title>
<ul>
<li>Authenticated Users -- Any user that has authenticated against an authentication service (e.g. Control Services) and does not have the admin role</li>
<li>Admin Users -- Any user that has authenticated against an authentication service and has the admin role returned by the authentication service in that Project's list of roles. The Admin role is HPE restricted.</li>
</ul>
</section>
<section id="32-regions"> <title>3.2 Regions</title>
<p>Region(s): region-a, region-b</p>
</section>
<section id="33-service-catalog"> <title>3.3 Service Catalog</title>
<p>The listing below shows a fragment of the Service Catalog returned by the Identity service which contains the endpoints for the Image service.</p>
<codeblock>
  <codeph>{
    endpoints: [2]
        1:  {
        links: {
        self: "https://region-b.geo-1.identity.hpcloudsvc.com/v3/endpoints/14000300_P"
        }
        url: "https://region-b.geo-1.images.hpcloudsvc.com:443/v1.0"
        region: "region-b.geo-1"
        interface: "public"
        service_Id: "140"
        id: "14000300_P"
        }
        2:  {
        links: {
        self: "https://region-b.geo-1.identity.hpcloudsvc.com/v3/endpoints/14001200_P"
        }
        url: "https://region-a.geo-1.images.hpcloudsvc.com:443/v1.0"
        region: "region-a.geo-1"
        interface: "public"
        service_Id: "140"
        id: "14001200_P"
        }
        type: "image"
        id: "140"
        links: {
        self: "https://region-b.geo-1.identity.hpcloudsvc.com/v3/services/140"
        }
    name: "Image Management"
}
</codeph>
</codeblock>
</section>
<section id="4-rest-api-specifications"> <title>4. REST API Specifications</title>
</section>
<section id="41-service-api-operations"> <title>4.1 Service API Operations</title>
<p>
<b>Hosts</b>:<!--A BR tag was used here in the original source.-->
https://region-a.geo-1.images.hpcloudsvc.com:443/v1.0<!--A BR tag was used here in the original source.-->
https://region-b.geo-1.images.hpcloudsvc.com:443/v1.0</p>
<p>
<b>BaseUri</b>: {Host}</p>
<table>
<tgroup cols="6">
<colspec colname="col1"/>
<colspec colname="col2"/>
<colspec colname="col3"/>
<colspec colname="col4"/>
<colspec colname="col5"/>
<colspec colname="col6"/>
<thead>
<row>
<entry align="left">Resource</entry>
  <entry align="left">Operation</entry>
  <entry align="left">HTTP Method</entry>
  <entry align="left">Path</entry>
  <entry align="left">JSON/XML Support?</entry>
  <entry align="center">Privilege Level</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left">
<b>Image Metadata</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4411-list-images">List Images</xref>
</entry>
  <entry align="left">GET</entry>
  <entry align="left">/images</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Metadata</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4412-list-images-in-more-detail">List Images Details</xref>
</entry>
  <entry align="left">GET</entry>
  <entry align="left">/images/detail</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Metadata</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4413-filtering-images-lists">Filtering Images Lists</xref>
</entry>
  <entry align="left">GET</entry>
  <entry align="left">/images?KEY=VALUE</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Metadata</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4414-filtering-on-custom-properties">Filtering on Custom Properties</xref>
</entry>
  <entry align="left">GET</entry>
  <entry align="left">/images/detail?property-KEY=VALUE</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Metadata</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4415-paginating-a-list-of-images">Paginating a List of Images</xref>
</entry>
  <entry align="left">GET</entry>
  <entry align="left">/images?limit=LIMIT&amp;marker=ID</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Metadata</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4416-retrieve-image-metadata">Retrieve Image Metadata</xref>
</entry>
  <entry align="left">HEAD</entry>
  <entry align="left">/images/{image_id}</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Metadata</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4417-update-an-image">Update an Image</xref>
</entry>
  <entry align="left">PUT</entry>
  <entry align="left">/images/{image_id}</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Data</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4421-retrieve-raw-image-data">Retrieve Raw Image Data</xref>
</entry>
  <entry align="left">GET</entry>
  <entry align="left">/images/{image_id}</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Data</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4422-add-a-new-image">Add a New Image</xref>
</entry>
  <entry align="left">POST</entry>
  <entry align="left">/images</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Data</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4423-two-step-adding-new-image">Two-step Adding New Image</xref>
</entry>
  <entry align="left">POST /images</entry>
  <entry align="left">PUT /images/{image_id}</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Memberships</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4431-list-image-memberships">List Image Memberships</xref>
</entry>
  <entry align="left">GET</entry>
  <entry align="left">/images/{image_id}/members</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Memberships</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4432-list-shared-images">List Shared Images</xref>
</entry>
  <entry align="left">GET</entry>
  <entry align="left">/shared-images/{project_id}</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Memberships</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4433-add-a-member-to-an-image">Add a Member to an Image</xref>
</entry>
  <entry align="left">PUT</entry>
  <entry align="left">/images/{image_id}/members/{project_id}</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Memberships</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4434-remove-a-member-from-an-image">Remove a Member from an Image</xref>
</entry>
  <entry align="left">DELETE</entry>
  <entry align="left">/images/members/{project_id}</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
<row>
<entry align="left">
<b>Image Memberships</b>
</entry>
  <entry align="left">
<xref type="section" href="#topic35632/4435-replace-a-membership-list-for-an-image">Replace a Membership List for an Image</xref>
</entry>
  <entry align="left">PUT</entry>
  <entry align="left">/images/{image_id}/members</entry>
  <entry align="left">Y/N</entry>
  <entry align="center"/>
</row>
</tbody>
</tgroup>
</table>
</section>
<section id="42-common-request-headers"> <title>4.2 Common Request Headers</title>
</section>
<section id="421-accept"> <title>4.2.1 Accept</title>
<p>Where applicable, this determines what Content-Types are acceptable, for example:</p>
<codeblock>
  <codeph>text (text/plain)
JSON (application/json)
</codeph>
</codeblock>
</section>
<section id="422-content-type"> <title>4.2.2 Content-Type</title>
<p>Where applicable, this indicates the MIME type of an object. For example when adding a new image a header of <codeph>Content-Type: application/octet-stream</codeph> should be specified.</p>
</section>
<section id="423-x-auth-token"> <title>4.2.3 X-Auth-Token</title>
<p>When specified, this identifies the user making the request. See section 2.4 for more information about tokens.</p>
</section>
<section id="424-content-length"> <title>4.2.4 Content-Length</title>
<p>Where applicable, this is the length in bytes of the body of the request.</p>
</section>
<section id="43-common-response-headers"> <title>4.3 Common Response Headers</title>
</section>
<section id="431-content-type"> <title>4.3.1 Content-Type</title>
<p>When the response includes a body, this indicates the MIME type of the response.</p>
</section>
<section id="432-content-length"> <title>4.3.2 Content-Length</title>
<p>When the response includes a body, this indicates the length of the body in bytes.</p>
</section>
<section id="44-service-api-operation-details"> <title>4.4 Service API Operation Details</title>
</section>
<section id="441-image-metadata"> <title>4.4.1 Image Metadata</title>
<p>Status Lifecycle: N/A</p>
<p>Rate Limits: N/A</p>
<p>Quota Limits: N/A</p>
<p>Business Rules: None</p>
</section>
<section id="4411-list-images"> <title>4.4.1.1 List Images</title>
</section>
<section id="get-images"> <title>GET /images</title>
<p>Retrieve a list of available images that the authenticated user has access to. This includes images owned by the user, images shared with the user and public images.</p>
<p>
  <b>Status Codes</b>
</p>
<p>200 - OK</p>
<p>
  <b>URL Parameters</b>
</p>
<ul>
<li>limit=LIMIT</li>
</ul>
<p>The <codeph>LIMIT</codeph> is a numeric value that you wish to limit the number of images returned per call. If no limit specified, Glance returns <b>25</b> images at a time by default.</p>
<ul>
<li>marker=ID</li>
</ul>
<p>The <codeph>marker</codeph> query parameter is to specify an image id <b>after</b> which the page of images starts. The image with the ID specified will not be shown.</p>
<p>See section 4.4.1.3 for more parameters that can be used for filtering.</p>
<p>
  <b>Request Data</b>
</p>
<p>No request body required.</p>
<p>
  <b>Response Data</b>
</p>
<p>JSON-encoded data. For example:</p>
<codeblock>
  <codeph>{'images':
  [
    {
     'name': 'Ubuntu 12.04 Plain',
     'disk_format': 'vhd',
     'container_format': 'ovf',
     'size': 5368709120,
     'checksum': '61eabaf2bf278703738b433ff884c91f',
     'id': "50928dd9-d57b-4b42-8f88-bdc4ccf16695"
    }
  ]
}
</codeph>
</codeblock>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X GET -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' {BaseURI}/images
</codeph>
</codeblock>
</section>
<section id="4412-list-images-in-more-detail"> <title>4.4.1.2 List Images in More Detail</title>
</section>
<section id="get-imagesdetail"> <title>GET /images/detail</title>
<p>Retrieve a more detailed list of available images that the authenticated user has access to. This includes images owned by the user, images shared with the user and public images.</p>
<p>
  <b>Status Codes</b>
</p>
<p>200 - OK</p>
<p>
  <b>URL Parameters</b>
</p>
<ul>
<li>limit=LIMIT</li>
</ul>
<p>The <codeph>LIMIT</codeph> is a numeric value that you wish to limit the number of images returned per call. If no limit specified, Glance returns <b>25</b> images at a time by default.</p>
<ul>
<li>marker=ID</li>
</ul>
<p>The <codeph>marker</codeph> query parameter is to specify an image id after which the page of images starts.</p>
<p>
  <b>Request Data</b>
</p>
<p>No request body required.</p>
<p>
  <b>Response Data</b>
</p>
<p>JSON-encoded data. For example:</p>
<codeblock>
  <codeph>{'images':
  [
    {
     "status": "active", 
     "name": "UbuntuServer2-snap1", 
     "deleted": false, 
     "container_format": "bare", 
     "created_at": "2012-11-07T14:36:00", 
     "disk_format": "qcow2", 
     "updated_at": "2012-11-07T14:36:34", 
     "properties": {
        "instance_uuid": "a249a5a4-66ff-4b9c-a90b-d0ec5419f074", 
        "image_location": "snapshot", 
        "image_state": "available", 
        "user_id": "96028022561439", 
        "creator": "XXX", 
        "image_type": "snapshot", 
        "instance_ref": "http://nv1.example.net/v1.1/355478", 
        "ramdisk_id": null, 
        "kernel_id": null, 
        "backup_type": null, 
        "version": "1.0.0", 
        "architecture": "amd64", 
        "owner_id": "16488133588404"
     },
     "min_disk": 0, 
     "id": "50928dd9-d57b-4b42-8f88-bdc4ccf16695", 
     "checksum": "c5d96e1cf62c0bcf9c633f14e2f01c3e", 
     "owner": "16488133588404", 
     "is_public": false, 
     "deleted_at": null, 
     "min_ram": 0, 
     "size": 686751744
    }
  ]
}
</codeph>
</codeblock>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X GET -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' {BaseURI}/images/detail
</codeph>
</codeblock>
</section>
<section id="4413-filtering-images-lists"> <title>4.4.1.3 Filtering Images Lists</title>
</section>
<section id="get-imageskeyvalue"> <title>GET /images?{key=value}</title>
<p>Both the <codeph>GET /v1/images</codeph> and <codeph>GET /v1/images/detail</codeph> requests take certain query parameters that serve to filter the returned list of images.</p>
<p>
  <b>Status Codes</b>
</p>
<p>200 - OK</p>
<p>
  <b>URL Parameters</b>
</p>
<ul>
<li>name=NAME</li>
</ul>
<p>Showing images having a name attribute matching NAME.</p>
<ul>
<li>container_format=FORMAT</li>
</ul>
<p>Showing images having a container_format attribute matching FORMAT</p>
<ul>
<li>disk_format=FORMAT</li>
</ul>
<p>Showing images having a disk_format attribute matching FORMAT</p>
<ul>
<li>status=STATUS</li>
</ul>
<p>Showing images having a status attribute matching STATUS</p>
<ul>
<li>size_min=BYTES</li>
</ul>
<p>Showing images having a size attribute greater than or equal to BYTES</p>
<ul>
<li>size_max=BYTES</li>
</ul>
<p>Showing images having a size attribute less than or equal to BYTES</p>
<ul>
<li>is_public=PUBLIC</li>
</ul>
<p>An admin user may use the <codeph>is_public</codeph> parameter to control which results are returned.</p>
<p>When the <codeph>is_public</codeph> parameter is absent or set to <codeph>True</codeph> the following images will be listed: Images whose <codeph>is_public</codeph> field is <codeph>True</codeph>, owned images and shared images.</p>
<p>When the <codeph>is_public</codeph> parameter is set to <codeph>False</codeph> the following images will be listed: Images (owned, shared, or non-owned) whose <codeph>is_public</codeph> field is <codeph>False</codeph>.</p>
<p>When the <codeph>is_public</codeph> parameter is set to <codeph>None</codeph> all images will be listed irrespective of owner, shared status or the <codeph>is_public</codeph> field.</p>
<p>Note: Use of the <codeph>is_public</codeph> parameter is restricted to admin users. For all other users it will be ignored.</p>
<ul>
<li>sort_key=KEY</li>
</ul>
<p>Results will be ordered by the specified image attribute <codeph>KEY</codeph>. Accepted values include <codeph>id</codeph>, <codeph>name</codeph>, <codeph>status</codeph>, <codeph>disk_format</codeph>, <codeph>container_format</codeph>, <codeph>size</codeph>, <codeph>created_at</codeph> (default) and <codeph>updated_at</codeph>.</p>
<ul>
<li>sort_dir=DIR</li>
</ul>
<p>Results will be sorted in the direction <codeph>DIR</codeph>. Accepted values are <codeph>asc</codeph> for ascending or <codeph>desc</codeph> (default) for descending.</p>
<p>
  <b>Request Data</b>
</p>
<p>No request body required</p>
<p>
  <b>Response Data</b>
</p>
<p>JSON-encoded data. See the following for example.</p>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X GET -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' {BaseURI}/images?{key=value}
</codeph>
</codeblock>
</section>
<section id="4414-filtering-on-custom-properties"> <title>4.4.1.4 Filtering on Custom Properties</title>
</section>
<section id="get-imagesdetailpropertykeyvalue"> <title>GET /images/detail?property={key=value}</title>
<p>A list of images can be filtered based on custom properties.</p>
<p>
  <b>Status Codes</b>
</p>
<p>200 - OK</p>
<p>
  <b>URL Parameters</b>
</p>
<p>Any custom property name</p>
<p>
  <b>Request Data</b>
</p>
<p>No request body required</p>
<p>
  <b>Response Data</b>
</p>
<p>JSON-encoded data. See the following for example.</p>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X GET -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' {BaseURI}/images/detail?property={key=value}
</codeph>
</codeblock>
</section>
<section id="4415-paginating-a-list-of-images"> <title>4.4.1.5 Paginating a list of images</title>
</section>
<section id="get-imageslimitlimitmarkerid"> <title>GET /images?limit=LIMIT&amp;marker=ID</title>
<p>A combination of <b>limit</b> and <b>marker</b> query parameters can be used to paginate a list of images. For example the following request will confine the resulting page length to be LIMIT, and the first image of this page is the one right after ID.</p>
<p>
  <b>Status Codes</b>
</p>
<p>200 - OK</p>
<p>
  <b>URL Parameters</b>
</p>
<ul>
<li>
<p>limit</p>
</li>
<li>
<p>marker</p>
</li>
</ul>
<p>
  <b>Request Data</b>
</p>
<p>No request body required</p>
<p>
  <b>Response Data</b>
</p>
<p>JSON-encoded data. See the following for example.</p>
<p>
  <b>Curl Example</b>
</p>
<p>First we request a list of images without specifying the <b>limit</b> parameter, as a result 25 images were returned.</p>
<codeblock>
  <codeph>curl -i -k -X GET -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' {BaseURI}/images?limit=LIMIT&amp;marker=ID
</codeph>
</codeblock>
<p>Then we set the page length to be 3 by <b>limit</b>, and try to retrieve the images that are after <b>d69ede19-2145-4933-806f-e82ef103098f</b> in the list above. So we got:</p>
<codeblock>
  <codeph>curl -v -k -X GET -H "x-auth-token: ***" "https://localhost:9292/v1/images?limit=3&amp;marker=d69ede19-2145-4933-806f-e82ef103098f"

&gt; GET /v1/images?limit=3&amp;marker=d69ede19-2145-4933-806f-e82ef103098f HTTP/1.1
&gt; Host: localhost:9292
&gt; Accept: */*
&gt; x-auth-token: ***
&gt;
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=UTF-8
&lt; Content-Type: application/json
&lt; Content-Length: 456
&lt; X-Openstack-Request-Id: req-b135294c-7700-48cc-be0e-e00123c508a7
&lt; Date: Sat, 26 Jan 2013 03:08:16 GMT
&lt;

{"images": [
  {"name": "Server1-snap1", "container_format": "bare", "disk_format": "qcow2", "checksum": "2ceadb1ab14775fc809b13301cbe2f10", "id": "d4388c1f-0047-4b46-9ad0-4ffd83b836eb", "size": 686751744},
  {"name": "Server1-snap1", "container_format": "bare", "disk_format": "qcow2", "checksum": "7402dab7e233cb81d8d9cc8b0b4d10e1", "id": "d313cbdb-152f-4cf9-a2c0-06b23d6afa01", "size": 686751744},
  {"name": "Server1-snap1", "container_format": "bare", "disk_format": "qcow2", "checksum": "241001b584803f30e3b6b135a66e3b09", "id": "50928dd9-d57b-4b42-8f88-bdc4ccf89000", "size": 686751744}
]}
</codeph>
</codeblock>
</section>
<section id="4416-retrieve-image-metadata"> <title>4.4.1.6 Retrieve Image Metadata</title>
</section>
<section id="head-imagesimage-id"> <title>HEAD /images/{image_id}</title>
<p>
  <b>Status Codes</b>
</p>
<p>200 - OK</p>
<p>
  <b>Request Data</b>
</p>
<p>No request body required</p>
<p>
  <b>Response Data</b>
</p>
<p>The metadata is returned as a set of HTTP headers that begin with the prefix <codeph>x-image-meta-</codeph>.</p>
<p>For example:</p>
<codeblock>
  <codeph>X-Image-Meta-Property-User_id: 96028022561439
X-Image-Meta-Status: active
X-Image-Meta-Property-Image_state: available
X-Image-Meta-Min_disk: 0
X-Image-Meta-Owner: 16488133588404
X-Image-Meta-Property-Instance_ref: http://nv1.example.net/v1.1/355478
X-Image-Meta-Name: Server2-snap1
X-Image-Meta-Container_format: bare
X-Image-Meta-Property-Image_type: snapshot
X-Image-Meta-Created_at: 2012-11-07T14:36:00
X-Image-Meta-Property-Image_location: snapshot
X-Image-Meta-Min_ram: 0
X-Image-Meta-Updated_at: 2012-11-07T14:36:34
X-Image-Meta-Property-Backup_type:
X-Image-Meta-Id: 23a4120c-b394-41b1-834d-6ab04fca3358
X-Image-Meta-Property-Instance_uuid: a249a5a4-66ff-4b9c-a90b-d0ec5419f074
X-Image-Meta-Deleted_at:
X-Image-Meta-Property-Ramdisk_id:
X-Image-Meta-Property-Architecture: amd64
X-Image-Meta-Property-Kernel_id:
X-Image-Meta-Deleted: False
X-Image-Meta-Checksum: c5d96e1cf62c0bcf9c633f14e2f01c3e
X-Image-Meta-Property-Creator: XXX
X-Image-Meta-Size: 686751744
X-Image-Meta-Property-Version: 1.0.0
X-Image-Meta-Is_public: False
X-Image-Meta-Property-Owner_id: 16488133588404
X-Image-Meta-Disk_format: qcow2
</codeph>
</codeblock>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X HEAD -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' {BaseURI}/images/{image_id}
</codeph>
</codeblock>
</section>
<section id="4417-update-an-image"> <title>4.4.1.7 Update an Image</title>
</section>
<section id="put-imagesimage-id"> <title>PUT /images/{image_id}</title>
<p>
  <b>Status Codes</b>
</p>
<p>200 - OK</p>
<p>
  <b>Request Data</b>
</p>
<p>All the request headers prefixed with <codeph>x-image-meta-</codeph> and <codeph>x-image-meta-property-</codeph> are recognized as image metadata.</p>
<p>If an image was previously reserved, and thus is in the <codeph>queued</codeph> state, then image raw data can be added by including it as the request body. If the image already has data associated with it (e.g. not in the <codeph>queued</codeph> state), then including a request body will result in a 409 Conflict.</p>
<p>
  <b>Response Data</b>
</p>
<p>On success, the <codeph>PUT</codeph> request will return the image metadata encoded as HTTP headers.</p>
<p>
  <b>Curl Example</b>
</p>
<p>This example shows how to update metadata on an image.</p>
<codeblock>
  <codeph>curl -i -k -X PUT -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' -H "{key:value}" {BaseURI}/images/{image_id}
</codeph>
</codeblock>
</section>
<section id="442-image-data"> <title>4.4.2 Image data</title>
<p>Status Lifecycle: N/A</p>
<p>Rate Limits: N/A</p>
<p>Quota Limits: N/A</p>
<p>Business Rules: None</p>
</section>
<section id="4421-retrieve-raw-image-data"> <title>4.4.2.1 Retrieve Raw Image Data</title>
</section>
<section id="get-imagesimage-id"> <title>GET /images/{image_id}</title>
<p>
  <b>Status Codes</b>
</p>
<p>200 - OK</p>
<p>
  <b>Request Data</b>
</p>
<p>No request body required</p>
<p>
  <b>Response Data</b>
</p>
<p>The metadata is returned as a set of HTTP headers that begin with the prefix <codeph>x-image-meta-</codeph>, and the image itself is encoded into the response body.</p>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X GET -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' {BaseURI}/images/{image_id}
</codeph>
</codeblock>
</section>
<section id="4422-add-a-new-image"> <title>4.4.2.2 Add a New Image</title>
</section>
<section id="post-images"> <title>POST /images</title>
<p>
  <b>Status Codes</b>
</p>
<p>201 - CREATED</p>
<p>
  <b>Request Data</b>
</p>
<p>The metadata of the image is sent to the Image service in HTTP headers. The body of the HTTP request to the API will be the MIME-encoded image data.</p>
<p>Image Metadata in HTTP Headers:</p>
<p>All HTTP headers prefixed with <codeph>x-image-meta-</codeph> and <codeph>x-image-meta-property-</codeph> are recognized as image metadata.</p>
<p>The list of metadata headers are listed below.</p>
<ul>
<li>x-image-meta-name (required)</li>
</ul>
<p>The name of the image.</p>
<ul>
<li>x-image-meta-id (optional)</li>
</ul>
<p>The Image service will use the supplied identifier for the image if specified. A 409 Conflict will be returned if an identifier already exists in that Image service region.</p>
<p>The Image service will generate an identifier for the image and return this identifier in the response if not specified.</p>
<ul>
<li>x-image-meta-disk_format (required)</li>
</ul>
<p>Valid values are one of aki, ari, ami, raw, iso, vhd, vdi, qcow2, or vmdk.</p>
<ul>
<li>x-image-meta-container_format (required)</li>
</ul>
<p>Valid values are one of aki, ari, ami, bare, or ovf.</p>
<ul>
<li>x-image-meta-size (optional)</li>
</ul>
<p>The Image service assumes the supplied value is the expected size if specified. A 400 Bad Request will be returned if the length in bytes of the request body does not match the value of this header.</p>
<p>The Image service will set the image's size based on the size of the request body if not specified.</p>
<ul>
<li>x-image-meta-checksum (optional)</li>
</ul>
<p>The Image service will verify the checksum generated from the backend store against the supplied checksum value if specified, a 400 Bad Request will be returned if not match.</p>
<p>The Image service will calculate the MD5 checksum based on the image data in the request body if not specified.</p>
<ul>
<li>x-image-meta-min-ram (optional)</li>
</ul>
<p>The Image service views the supplied value as the minimum ram required in megabytes to run this image on a server if specified.</p>
<p>The Image service considers the minimum ram requirement is 0 for this image if not specified.</p>
<ul>
<li>x-image-meta-min-disk (optional)</li>
</ul>
<p>The Image service views the supplied value as the minimum disk space required in gigabytes to run this image on a server if specified.</p>
<p>The Image service considers the minimum disk space requirement is 0 for this image if not specified.</p>
<ul>
<li>x-image-meta-owner (optional)</li>
</ul>
<p>This header is only meaningful for admins.</p>
<p>The Image service normally sets the owner of an image to be the Project ID of the authenticated user issuing the request. However, if the authenticated user has the Admin role, this default may be overridden by setting this header to null or to a string identifying the owner of the image.</p>
<ul>
<li>x-image-meta-property-*</li>
</ul>
<p>When the Image service receives any HTTP header whose key begins with the prefix <codeph>x-image-meta-property-</codeph>, the Image service adds the key and value to a set of custom, free-form image properties stored with the image. The key is the lower-cased string following the prefix x-image-meta-property- with dashes and punctuation replaced with underscores.</p>
<p>For example, if the following HTTP header were sent:</p>
<p>
<codeph>x-image-meta-property-architecture  amd64</codeph>
Then a key/value pair of "architecture"/"amd64" will be stored as image metadata with the image in the Image service.</p>
<p>There is no limit on the number of free-form key/value attributes that can be attached to the image. However, keep in mind that the 8K limit on the size of all HTTP headers sent in a request will effectively limit the number of image properties.</p>
<p>
  <b>Response Data</b>
</p>
<p>JSON-encoded metadata of the new image. See the following for example.</p>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X POST -H 'X-Auth-Token: {Auth_Token}' -H "X-Image-Meta-Name: post_example" -H "X-Image-Meta-disk_format: raw" -H "x-image-meta-container_format: bare" -H "Content-Type: application/octet-stream" --data-binary @/home/lijam/img-800k {BaseURI}/images

&gt; POST /v1/images HTTP/1.1
&gt; Host: localhost:9292
&gt; Accept: */*
&gt; x-auth-token: ***
&gt; X-Image-Meta-Name: post_example
&gt; X-Image-Meta-disk_format: raw
&gt; x-image-meta-container_format: bare
&gt; Content-Type: application/octet-stream
&gt; Content-Length: 819200
&gt; Expect: 100-continue
&gt;
&lt; HTTP/1.1 100 Continue
&lt; HTTP/1.1 201 Created
&lt; Content-Type: application/json
&lt; Content-Length: 441
&lt; Location: https://localhost:9292/v1/images/50928dd9-d57b-4b42-8f88-bdc4ccf16695
&lt; Etag: 3f8ad80bece5aabec127446bf3bd7a02
&lt; X-Openstack-Request-Id: req-13d89606-3b04-4d45-b0e4-ea1e6c7d743e
&lt; Date: Tue, 05 Mar 2013 04:38:11 GMT
&lt;
{"image": {"status": "active", "name": "post_example", "deleted": false, "container_format": "bare", "created_at": "2013-03-05T04:38:10", "disk_format": "raw", "updated_at": "2013-03-05T04:38:11", "properties": {}, "min_disk": 0, "protected": false, "id": "50928dd9-d57b-4b42-8f88-bdc4ccf16695", "checksum": "3f8ad80bece5aabec127446bf3bd7a02", "owner": "34096082065107", "is_public": false, "deleted_at": null, "min_ram": 0, "size": 819200}}
</codeph>
</codeblock>
</section>
<section id="4423-two-step-adding-new-image"> <title>4.4.2.3 Two-step Adding New Image</title>
</section>
<section id="post-images2"> <title>POST /images</title>
</section>
<section id="put-imagesimage-id2"> <title>PUT /images/{image_id}</title>
<p>Another way to add a new image to the Image service is to first register an image via a POST request and then upload the image data via a PUT.</p>
<p>
  <b>Status Codes</b>
</p>
<p>POST: 201 - CREATED</p>
<p>PUT: 200 - OK</p>
<p>
  <b>Request Data</b>
</p>
<p>POST: 'x-image-meta-name', 'X-Image-Meta-disk_format' and 'x-image-meta-container_format' are required, no request body required</p>
<p>PUT: 'Content-Type' is required, request body should be the image data</p>
<p>
  <b>Response Data</b>
</p>
<p>POST: JSON-encoded metadata</p>
<p>PUT: JSON-encoded metadata</p>
<p>See the following for example.</p>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X PUT -H 'X-Auth-Token: {Auth_Token}' -H "Content-Type: application/octet-stream" --data-binary @/home/lijam/img-800k {BaseURI}/images/{image_id}

&gt; PUT /v1/images/c639c44f-32df-4734-9baa-7f7452337ffc HTTP/1.1
&gt; Host: localhost:9292
&gt; Accept: */*
&gt; x-auth-token: ***
&gt; Content-Type: application/octet-stream
&gt; Content-Length: 819200
&gt; Expect: 100-continue
&gt;
&lt; HTTP/1.1 100 Continue
&lt; HTTP/1.1 200 OK
&lt; Content-Length: 441
&lt; Content-Type: application/json
&lt; Location: https://localhost:9292/v1/images/c639c44f-32df-4734-9baa-7f7452337ffc
&lt; Etag: 3f8ad80bece5aabec127446bf3bd7a02
&lt; X-Openstack-Request-Id: req-dd31ebbf-8bd2-4b8c-9a45-4cf9622fb23d
&lt; Date: Tue, 05 Mar 2013 04:44:08 GMT
&lt;
{"image": {"status": "active", "name": "post_example", "deleted": false, "container_format": "bare", "created_at": "2013-03-05T04:41:17", "disk_format": "raw", "updated_at": "2013-03-05T04:44:08", "properties": {}, "min_disk": 0, "protected": false, "id": "c639c44f-32df-4734-9baa-7f7452337ffc", "checksum": "3f8ad80bece5aabec127446bf3bd7a02", "owner": "34096082065107", "is_public": false, "deleted_at": null, "min_ram": 0, "size": 819200}}
</codeph>
</codeblock>
</section>
<section id="443-image-membership"> <title>4.4.3 Image Membership</title>
<p>Status Lifecycle: N/A</p>
<p>Rate Limits: N/A</p>
<p>Quota Limits: N/A</p>
<p>Business Rules: None</p>
</section>
<section id="4431-list-image-memberships"> <title>4.4.3.1 List Image Memberships</title>
</section>
<section id="get-imagesimage-idmembers"> <title>GET /images/{image_id}/members</title>
<p>Retrieve a list of the other Projects that may access a given image.</p>
<p>
  <b>Status Codes</b>
</p>
<p>200 - OK</p>
<p>
  <b>Request Data</b>
</p>
<p>No request body required</p>
<p>
  <b>Response Data</b>
</p>
<p>JSON data</p>
<codeblock>
  <codeph>{'members': [
 {'member_id': '12345',
  'can_share': false}
 ]}
</codeph>
</codeblock>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X GET -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' {BaseURI}/images/{image_id}/members
</codeph>
</codeblock>
</section>
<section id="4432-list-shared-images"> <title>4.4.3.2 List Shared Images</title>
</section>
<section id="get-shared-imagesproject-id"> <title>GET /shared-images/{project_id}</title>
<p>Retrieve a list of images which are shared with a given Project.</p>
<p>
  <b>Status Codes</b>
</p>
<p>200 - OK</p>
<p>
  <b>Request Data</b>
</p>
<p>No request body required</p>
<p>
  <b>reponse</b>
</p>
<p>JSON data</p>
<codeblock>
  <codeph>{'shared_images': [
 {'image_id': 'd313cbdb-152f-4cf9-a2c0-06b23d6afa01',
  'can_share': false}
 ]}
</codeph>
</codeblock>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X GET -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' {BaseURI}/shared-images/{project_id}
</codeph>
</codeblock>
</section>
<section id="4433-add-a-member-to-an-image"> <title>4.4.3.3 Add a Member to an Image</title>
</section>
<section id="put-imagesimage-idmembersproject-id"> <title>PUT /images/{image_id}/members/{project_id}</title>
<p>To authorize a Project to access a private image.</p>
<p>
  <b>Status Codes</b>
</p>
<p>204 - No Content</p>
<p>
  <b>Request Data</b>
</p>
<p>With no body, this will add the membership to the image, leaving existing memberships unchanged and defaulting new memberships to have <codeph>can_share</codeph> set to false.</p>
<p>If the following body is specified, both existing and new memberships will have <codeph>can_share</codeph> set to the supplied value.</p>
<codeblock>
  <codeph>{'member':
 {'can_share': true}
}
</codeph>
</codeblock>
<p>
  <b>Response Data</b>
</p>
<p>No response body</p>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X PUT -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' -d '{"memberships": [{"member_id": "{member_id}", "can_share": false}]}' {BaseURI}/images/{image_id}/members/{project_id}
</codeph>
</codeblock>
</section>
<section id="4434-remove-a-member-from-an-image"> <title>4.4.3.4 Remove a Member from an Image</title>
</section>
<section id="delete-imagesimage-idmembersproject-id"> <title>DELETE /images/{image_id}/members/{project_id}</title>
<p>To revoke a Project's right to access a private image.</p>
<p>
  <b>Status Codes</b>
</p>
<p>This query will return a 204 ("No Content") status code.</p>
<p>
  <b>Request Data</b>
</p>
<p>No request body</p>
<p>
  <b>Response Data</b>
</p>
<p>No response body</p>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X DELETE -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' {BaseURI}/images/{image_id}/members/{project_id}
</codeph>
</codeblock>
</section>
<section id="4435-replace-a-membership-list-for-an-image"> <title>4.4.3.5 Replace a Membership List for an Image</title>
</section>
<section id="put-imagesimage-idmembers"> <title>PUT /images/{image_id}/members</title>
<p>The full membership list for a given image may be replaced.</p>
<p>
  <b>Status Codes</b>
</p>
<p>204 - No Content</p>
<p>
  <b>Request Data</b>
</p>
<p>A body in the following form:</p>
<codeblock>
  <codeph>{'memberships': [
 {'member_id': 'tenant1',
  'can_share': false}
 ...]}
</codeph>
</codeblock>
<p>All the supplied memberships will be created, having <codeph>can_share</codeph> set to false by default if not specified.</p>
<p>The existing memberships named in the body will have their <codeph>can_share</codeph> set to the specified value, or keep the existing values unchanged if the corresponding <codeph>can_share</codeph> is not specified in the body.</p>
<p>All existing memberships which are not named in the body are removed.</p>
<p>
  <b>Response Data</b>
</p>
<p>No response body</p>
<p>
  <b>Curl Example</b>
</p>
<codeblock>
  <codeph>curl -i -k -X PUT -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'X-Auth-Token: {Auth_Token}' -d '{"memberships": [{"member_id": "{member_id}", "can_share": false}]}' {BaseURI}/images/{image_id}/members
</codeph>
</codeblock>
</section>
<section id="5-additional-notes"> <title>5. Additional Notes</title>
</section>
<section id="51-apiv1-differences-between-hp-helion-public-cloud-135-and-1212"> <title>5.1 APIv1 Differences between HPE Helion Public Cloud 13.5 and 12.12</title>
<table>
<tgroup cols="3">
<colspec colname="col1"/>
<colspec colname="col2"/>
<colspec colname="col3"/>
<thead>
<row>
<entry align="left"/>
  <entry align="left">1.1 (2013.1)</entry>
  <entry align="left">1.0 (2011.3)</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left">Image Identifier</entry>
  <entry align="left">UUID (for example: 6eab43da-eb20-4e43-8984-48fa057989c5)</entry>
  <entry align="left">Integer</entry>
</row>
<row>
<entry align="left">Get Metadata API</entry>
  <entry align="left">new response header "X-Openstack-Request-Id"</entry>
  <entry align="left">N/A</entry>
</row>
<row>
<entry align="left">Add new image API</entry>
  <entry align="left">"X-Image-Meta-Name", "X-Image-Meta-Disk_format", "X-Image-Meta-Container_format" are required</entry>
  <entry align="left">"X-Image-Meta-Name" is required</entry>
</row>
</tbody>
</tgroup>
</table>
</section>
</body>
</topic>